import{I as s}from"./index.77d610ea.js";import{P as y}from"./index.5b8b0d4c.js";import{R as b}from"./index.45eae9d1.js";import{B as n}from"./index.a979e08f.js";import{I as _}from"./index.5b84c5bd.js";import{C as k}from"./index.488de2f5.js";import{d as g,c as V}from"./vendor.b6844a64.js";import{K as $}from"./keyboardActive.acc7335a.js";import{c as P}from"./create.d5ed34a6.js";import{c as T}from"./relation.9e421618.js";import{a as o,i as f,N as l}from"./shared.c7f62d01.js";/* empty css               *//* empty css                 */import"./index.b0ae6451.js";const w=e=>["normal","small","mini"].includes(e),C={value:{type:[String,Array]},label:{type:[String,Number]},size:{type:String,default:"normal",validator:w},placeholder:{type:String},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},valueFormat:{type:String,default:"YYYY-MM-DD"},range:{type:Boolean,default:!1},customDisabled:{type:Function,default:()=>!1},validateTrigger:{type:Array,default:()=>["onChange","onClear"]},rules:{type:Array}};g.extend(V);const{createComponent:x,namespace:a}=P("date-picker"),v="YYYY-MM-DD",D=" - ",I=130,j=x({mixins:[$,T("form",{parentKey:"form",childrenKey:"formComponents"})],props:C,directives:{Ripple:b},data:()=>({enterPopover:!1,keyboardDisabled:!1,id:void 0,localValue:void 0}),watch:{value:{handler(e){this.localValue=e},immediate:!0}},computed:{displayValue(){return this.range&&o(this.localValue)?this.localValue.map(this.formatValueToDisplay).join(D):this.range&&!o(this.localValue)?"":f(this.localValue)?void 0:this.formatValueToDisplay(this.localValue)}},mounted(){this.id=this.$refs.input.id},methods:{reset(){this.$emit("input",this.range?[]:void 0),this.resetValidation()},validate(){return this.$refs.input.validate()},resetValidation(){this.$refs.input.resetValidation()},nextTickValidateWithTrigger(e){!this.validateTrigger.includes(e)||this.$nextTick(()=>{this.validate()})},toNow(){this.$refs.calendar.toNow()},focus(){this.$refs.input.focus()},blur(){var e;(e=this.$refs.input)==null||e.blur()},open(){this.$refs.popover.show||(this.$refs.popover.open(),this.keyboardDisabled=!1)},close(){var e,t;!((e=this.$refs.popover)==null?void 0:e.show)||((t=this.$refs.popover)==null||t.close(),this.keyboardDisabled=!0)},invalidRangeValue(){return this.range&&(!o(this.localValue)||this.localValue.length!==2)},formatValueToDisplay(e){return g(e,this.valueFormat).format(v)},handleKeydownEscape(){this.confirm()},confirm(){const e=this.invalidRangeValue()?[]:this.localValue;this.value!==e&&(this.$emit("input",e),this.$emit("change",e),this.nextTickValidateWithTrigger("onChange")),this.close(),requestAnimationFrame(this.blur)},handleClick(e){var t,r;((t=this.form)==null?void 0:t.disabled)||this.disabled||(this.$emit("click",e),this.nextTickValidateWithTrigger("onClick"),!(((r=this.form)==null?void 0:r.readonly)||this.readonly)&&this.focus())},handleClear(){const e=this.range?[]:void 0;this.$emit("clear",e),this.$emit("input",e),this.$emit("change",e),this.nextTickValidateWithTrigger("onClear"),this.nextTickValidateWithTrigger("onChange")},handleFocus(e){var t,r;((t=this.form)==null?void 0:t.disabled)||this.disabled||(this.$emit("focus",e),!(((r=this.form)==null?void 0:r.readonly)||this.readonly)&&this.open())},handleBlur(e){this.$emit("blur",e),!this.enterPopover&&this.confirm()},handleMouseenter(){this.enterPopover=!0},handleMouseleave(){this.enterPopover=!1},withPressing(e){let t;function r(){e(),t&&clearInterval(t),document.removeEventListener("touchend",r)}return()=>{document.addEventListener("touchend",r),t=setInterval(()=>{e()},I)}},renderAppendIcon(){const e=this.$createElement,t=e(s,{attrs:{"date-picker-cover":!0,name:"calendar"},class:a("__calendar-icon")}),r=this.clearable&&e(s,{attrs:{"date-picker-cover":!0,name:"close-circle"},class:[a("__clear-icon"),f(this.value)?a("--hide-clear-icon"):null],on:{click:this.handleClear}});return e("div",{class:a("__append-icon"),on:{click:i=>i.stopPropagation()}},[r,this.hasSlots("append-icon")?this.slots("append-icon"):t])},renderInput(){var t;return this.$createElement(_,{attrs:{"date-picker-cover":!0,label:this.label,value:this.displayValue,validateValue:this.value,rules:this.rules,validateTrigger:this.validateTrigger,placeholder:this.placeholder,size:this.size,readonly:!0,disabled:((t=this.form)==null?void 0:t.disabled)||this.disabled},ref:"input",on:{clear:this.handleClear,focus:this.handleFocus,blur:this.handleBlur,click:this.handleClick},scopedSlots:{"prepend-icon":()=>this.slots("prepend-icon"),"append-icon":this.renderAppendIcon}})},renderCalendarHeader({current:e}){var r,i,c,d,h,u,p,m;const t=this.$createElement;return t("div",{class:a("__calendar-header"),on:{click:this.focus}},[t(n,{class:a("__calendar-button"),attrs:{"date-picker-cover":!0,round:!0,text:!0},on:{touchstart:this.withPressing((i=(r=this.$refs.calendar)==null?void 0:r.prevYear)!=null?i:l)}},[t(s,{class:a("__calendar-arrow-icon"),attrs:{"date-picker-cover":!0,name:"arrow-left"}})]),t(n,{class:a("__calendar-button"),attrs:{"date-picker-cover":!0,round:!0,text:!0},on:{touchstart:this.withPressing((d=(c=this.$refs.calendar)==null?void 0:c.prevMonth)!=null?d:l)}},[t(s,{class:a("__calendar-arrow-icon"),attrs:{"date-picker-cover":!0,name:"chevron-left"}})]),t("div",{class:a("__calendar-month-panel")},[e.format(v)]),t(n,{class:a("__calendar-button"),attrs:{"date-picker-cover":!0,round:!0,text:!0},on:{touchstart:this.withPressing((u=(h=this.$refs.calendar)==null?void 0:h.nextMonth)!=null?u:l)}},[t(s,{class:a("__calendar-arrow-icon"),attrs:{"date-picker-cover":!0,name:"chevron-right"}})]),t(n,{class:a("__calendar-button"),attrs:{"date-picker-cover":!0,round:!0,text:!0},on:{touchstart:this.withPressing((m=(p=this.$refs.calendar)==null?void 0:p.nextYear)!=null?m:l)}},[t(s,{class:a("__calendar-arrow-icon"),attrs:{"date-picker-cover":!0,name:"arrow-right"}})])])},renderCalendar(){var t,r;return this.$createElement(k,{class:a("__calendar"),attrs:{"date-picker-cover":!0,disabled:((t=this.form)==null?void 0:t.disabled)||this.disabled,readonly:((r=this.form)==null?void 0:r.readonly)||this.readonly,value:this.localValue,valueFormat:this.valueFormat,range:this.range,customDisabled:this.customDisabled,ripple:!1},ref:"calendar",on:{input:i=>{this.localValue=i}},scopedSlots:{header:this.renderCalendarHeader}})}},render(){const e=arguments[0],{disabled:t,handleMouseenter:r,handleMouseleave:i}=this;return e("div",{class:[a(),t?a("--disabled"):null]},[e(y,{class:a("__popover"),attrs:{"date-picker-cover":!0,trigger:"manual",placement:"bottom-start",y:6,defaultStyle:!1},ref:"popover",on:{open:()=>this.$emit("open"),opened:()=>this.$emit("opened"),close:()=>this.$emit("close"),closed:()=>this.$emit("closed")},scopedSlots:{trigger:this.renderInput}},[e("label",{class:a("__popover-inner"),attrs:{for:this.id},on:{mouseenter:r,mouseleave:i}},[this.renderCalendar(),e("div",{class:a("__actions"),on:{click:this.focus}},[e(n,{class:a("__now-button"),attrs:{type:"primary",size:"small"},on:{click:this.toNow}},["Now"]),e(n,{class:a("__confirm-button"),attrs:{type:"primary",size:"small",disabled:this.invalidRangeValue()},on:{click:()=>this.confirm(this.localValue)}},["OK"])])])])])}});export{j as D};
