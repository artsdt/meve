var S=Object.defineProperty,_=Object.defineProperties;var b=Object.getOwnPropertyDescriptors;var u=Object.getOwnPropertySymbols;var O=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable;var m=(e,o,t)=>o in e?S(e,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[o]=t,d=(e,o)=>{for(var t in o||(o={}))O.call(o,t)&&m(e,t,o[t]);if(u)for(var t of u(o))T.call(o,t)&&m(e,t,o[t]);return e},f=(e,o)=>_(e,b(o));import{P as w}from"./index.503193fa.js";import{t as y,B as c}from"./index.a979e08f.js";import{I as x}from"./index.77d610ea.js";import{L as P}from"./index.4fc42c55.js";import{c as z}from"./create.d5ed34a6.js";/* empty css               */import{V as A}from"./vendor.b6844a64.js";import{j as D,c as I,b as V}from"./shared.c7f62d01.js";import{m as E}from"./components.b6372a71.js";const F=e=>["left","center","right"].includes(e),N={value:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},width:{type:[String,Number]},title:{type:String},message:{type:String},messageAlign:{type:String,default:"left",validator:F},confirmButton:{type:Boolean,default:!0},cancelButton:{type:Boolean,default:!0},confirmButtonText:{type:String},cancelButtonText:{type:String},confirmButtonType:{type:String,default:"primary",validator:y},cancelButtonType:{type:String,default:"primary",validator:y},overlay:{type:Boolean,default:!0},overlayClass:{type:String},overlayStyle:{type:Object},lockScroll:{type:Boolean,default:!0},closeOnClickOverlay:{type:Boolean,default:!0},beforeClose:{type:Function}};const{createComponent:j,namespace:s}=z("dialog"),h=j({props:N,data:()=>({show:!1,localCloseOnClickOverlay:!1}),watch:{value:{handler(e){this.show=e},immediate:!0},closeOnClickOverlay:{handler(e){if(this.normalizeBeforeClose()){this.localCloseOnClickOverlay=!1;return}this.localCloseOnClickOverlay=e},immediate:!0}},methods:{handleOpen(){this.$emit("open")},handleOpened(){this.$emit("opened")},handleClose(){this.$emit("close")},handleClosed(){this.$emit("closed")},handleRouteChange(){this.$emit("route-change")},normalizeBeforeClose(){return this.$listeners["before-close"]||this.beforeClose},done(){this.$emit("input",!1)},handleClickOverlay(){this.$emit("click-overlay");const e=this.normalizeBeforeClose();if(!(!this.closeOnClickOverlay||this.loading)){if(e){e("close",this.done.bind(this));return}this.done()}},handleClickCloseButton(){const e=this.normalizeBeforeClose();if(e){e("close",this.done.bind(this));return}this.done()},confirm(){const e=this.normalizeBeforeClose();if(this.$emit("confirm"),e){e("confirm",this.done.bind(this));return}this.done()},cancel(){const e=this.normalizeBeforeClose();if(this.$emit("cancel"),e){e("cancel",this.done.bind(this));return}this.done()},renderMessage(){const e=this.$createElement;if(this.hasSlots())return this.slots();if(this.message)return e("div",{class:s("__message"),style:{textAlign:this.messageAlign}},[this.message])},renderTitle(){var o;const e=this.$createElement;return this.hasSlots("title")?this.slots("title"):e("div",{class:s("__title")},[(o=this.title)!=null?o:"\u63D0\u793A"])},renderFooter(){var o,t;const e=this.$createElement;return this.hasSlots("footer")?this.slots("footer"):e("div",{class:s("__footer")},[this.confirmButton&&e(c,{class:s("__confirm-button"),attrs:{"dialog-cover":!0,size:"large",type:this.confirmButtonType},on:{click:this.confirm}},[(o=this.confirmButtonText)!=null?o:"\u786E\u8BA4"]),this.cancelButton&&e(c,{class:s("__cancel-button"),attrs:{"dialog-cover":!0,size:"large",type:this.cancelButtonType,text:!0},on:{click:this.cancel}},[(t=this.cancelButtonText)!=null?t:"\u53D6\u6D88"])])}},render(){const e=arguments[0],{show:o,loading:t,overlay:l,overlayClass:i,lockScroll:n,localCloseOnClickOverlay:C,handleOpen:p,handleOpened:g,handleClose:v,handleClosed:B,handleClickOverlay:k,handleRouteChange:$}=this;return e(w,{class:s(),attrs:{"dialog-cover":!0,value:o,overlay:l,overlayClass:i,lockScroll:n,closeOnClickOverlay:C},on:{open:p,opened:g,close:v,closed:B,clickOverlay:k,routeChange:$}},[e(P,{attrs:{loading:t,"dialog-cover":!0},class:s("__loading")},[e("div",{class:s("__container")},[e("div",{class:s("__title-wrapper")},[this.renderTitle(),e(c,{class:s("__close-button"),attrs:{"dialog-cover":!0,text:!0,round:!0},on:{click:this.handleClickCloseButton}},[e(x,{attrs:{name:"close"}})])]),this.renderMessage(),this.renderFooter()])])])}});let r;function a(e){return D()?new Promise(o=>{a.close();const t=I(e)||V(e)?{message:String(e)}:e,{instance:l,unmount:i}=E(h,"body",{propsData:f(d({},t),{beforeClose:t.onBeforeClose})});l.value=!0,r=l,l.$on("input",n=>{l.value=n}),l.$on("open",()=>{var n;return(n=t.onOpen)==null?void 0:n.call(t)}),l.$on("opened",()=>{var n;return(n=t.onOpened)==null?void 0:n.call(t)}),l.$on("click-overlay",()=>{var n;return(n=t.onClickOverlay)==null?void 0:n.call(t)}),l.$on("close",()=>{var n;(n=t.onClose)==null||n.call(t),o("close")}),l.$on("closed",()=>{var n;(n=t.onClosed)==null||n.call(t),i(),r===l&&(r=null)}),l.$on("confirm",()=>{var n;(n=t.onConfirm)==null||n.call(t),o("confirm")}),l.$on("cancel",()=>{var n;(n=t.onCancel)==null||n.call(t),o("cancel")}),l.$on("route-change",()=>{i(),r===l&&(r=null)})}):Promise.resolve()}a.close=()=>{if(r!=null){const e=r;r=null,A.nextTick(()=>{e.show=!1})}};a.Component=h;a.install=function(e){e.use(h)};export{a as D};
