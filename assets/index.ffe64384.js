var C=Object.defineProperty,y=Object.defineProperties;var I=Object.getOwnPropertyDescriptors;var g=Object.getOwnPropertySymbols;var L=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var h=(e,t,r)=>t in e?C(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,a=(e,t)=>{for(var r in t||(t={}))L.call(t,r)&&h(e,r,t[r]);if(g)for(var r of g(t))$.call(t,r)&&h(e,r,t[r]);return e},m=(e,t)=>y(e,I(t));import{I as v}from"./index.77d610ea.js";import{L as x}from"./index.4fc42c55.js";import{B as S}from"./index.a979e08f.js";import{r as b}from"./index.5b31b8c0.js";import{c as A}from"./create.d5ed34a6.js";import{e as T,t as k,c as _,b as w}from"./shared.c7f62d01.js";/* empty css               */import{m as z}from"./components.b6372a71.js";const P=e=>["top","bottom"].includes(e),p={position:{type:String,default:"top",validator:P}};const{createComponent:E,namespace:i}=A("message"),N={info:"information",warning:"warning",error:"error",success:"checkbox-marked-circle"},B=E({props:p,data:()=>({forbidClick:!1,messages:[]}),methods:{createMessage(e){e.lockScroll&&document.body.classList.add("m--lock"),e.forbidClick&&(this.forbidClick=!0),this.messages.push(e),b.zIndex++,e.duration!==1/0&&setTimeout(()=>this.removeMessage(e),e.duration)},removeMessage(e){if(!this.messages.includes(e))return;T(this.messages,e),this.$emit("remove",e.id);const t=this.messages.some(l=>l.lockScroll),r=this.messages.some(l=>l.forbidClick);t||document.body.classList.remove("m--lock"),r||(this.forbidClick=!1)},handleLeave(e){this.$emit("leave",k(e.getAttribute("item-id")))},handleAfterLeave(e){this.$emit("after-leave",k(e.getAttribute("item-id")))},renderTypeIcon(e){const t=this.$createElement;return e==="loading"?t(x,{attrs:{"message-cover":!0,loading:!0},class:i("__loading")}):t(v,{attrs:{"message-cover":!0,name:N[e]},class:i("__icon")})},renderMessageItem(){const e=this.$createElement;return this.messages.map(t=>e("div",{attrs:{"item-id":t.id},key:t.id,class:i("__item")},[e("div",{class:[i("__message-item"),i(`--${t.type}`)]},[e("div",{class:i("__main")},[this.renderTypeIcon(t.type),e("div",{class:i("__content")},[t.content])]),t.closeable&&e(S,{attrs:{"message-cover":!0,size:"mini",text:!0,round:!0},class:i("__close-button"),on:{click:()=>this.removeMessage(t)}},[e(v,{attrs:{"message-cover":!0,name:"close"},class:i("__close-icon")})])])]))}},render(){const e=arguments[0];return e("div",{class:[i(),"m--box",this.forbidClick&&i("--forbid-click")],style:{zIndex:b.zIndex}},[e("transition-group",{class:[i("__list"),i(`--${this.position}`)],attrs:{tag:"ul",name:"m-message-fade"},on:{leave:this.handleLeave,afterLeave:this.handleAfterLeave}},[this.renderMessageItem()])])}});let s,n,u=0,c=0,o={type:"success",position:"top",content:"",duration:3e3,closeable:!0,forbidClick:!1,lockScroll:!1};const d={loading:{},info:{},warning:{},error:{},success:{}};function M(e){if(!s){const t=z(B,"body");s=t.instance,n=t.unmount}s.$on("remove",t=>{var r;t===e.id&&((r=e.onClose)==null||r.call(e))}),s.$on("leave",t=>{var r;t===e.id&&((r=e.onLeave)==null||r.call(e))}),s.$on("after-leave",t=>{var r;t===e.id&&((r=e.onAfterLeave)==null||r.call(e),c--,c===0&&O())}),s.position=e.position,s.createMessage(e),c++}function O(){s&&n&&(n(),s=null,n=null,c=0,u=0)}const f=function(e){return(_(e)||w(e))&&(e={content:String(e)}),e=m(a(a({},o),e),{id:u++}),M(e),{clear:()=>s==null?void 0:s.removeMessage(e)}},F=["loading","info","warning","error","success"];F.forEach(e=>{f[e]=function(t){return _(t)&&(t={content:t}),t=a(a({},d[e]),t),t=m(a(a({},o),t),{id:u++,type:e}),M(t),{clear:()=>s==null?void 0:s.removeMessage(t)}}});f.config=function(e){o=a(a({},o),e)};f.configType=function(e,t){d[e]=a(a({},d[e]),t)};export{f as M};
