import{R as g}from"./index.45eae9d1.js";import{L as y}from"./index.0f6a93ff.js";import{P as f}from"./index.503193fa.js";import{B as r}from"./index.a979e08f.js";import{S as w}from"./index.151060a5.js";import{I as a}from"./index.77d610ea.js";import{c as b}from"./create.d5ed34a6.js";import{a as s}from"./elements.024da98f.js";import{n as _}from"./components.b6372a71.js";/* empty css               *//* empty css              */import{K as P}from"./keyboardActive.acc7335a.js";function k(t){return["fill","contain","cover","none","scale-down"].includes(t)}const z={src:{type:String},fit:{type:String,validator:k,default:"fill"},alt:{type:String},width:{type:[String,Number]},height:{type:[String,Number]},radius:{type:[String,Number],default:0},loading:{type:String},error:{type:String},lazy:{type:Boolean,default:!1},ripple:{type:Boolean,default:!1},block:{type:Boolean,default:!0},previewDisabled:{type:Boolean,default:!1}};const{createComponent:A,namespace:e}=b("image"),T=.5,c=.5,m=90,u=200,B=A({directives:{Ripple:g,Lazy:y},mixins:[P],props:z,watch:{showPreview(t){t&&this.resetAll()}},data:()=>({initPreview:!1,showPreview:!1,scale:.5,rotate:0,translateX:0,translateY:0,prevX:0,prevY:0,touching:!1,transitionDuration:void 0}),methods:{handleLoad(t){const i=t.currentTarget;this.lazy?(i._lazy.state==="success"&&this.$emit("load",t),i._lazy.state==="error"&&this.$emit("error",t)):this.$emit("load",t)},handleError(t){!this.lazy&&this.$emit("error",t)},async handleClick(t){this.$emit("click",t),!this.previewDisabled&&(this.initPreview||(this.initPreview=!0,await _()),this.showPreview=!0,this.keyboardDisabled=!1)},handleKeydownEscape(){this.closePreview()},resetTranslate(){this.translateX=0,this.translateY=0},resetAll(){this.resetTranslate(),this.scale=.5,this.rotate=0,this.enableAnimation()},enableAnimation(){this.transitionDuration=u,setTimeout(()=>{this.transitionDuration=0},u)},zoomIn(){this.scale+=c,this.enableAnimation()},zoomOut(){this.scale<=T||(this.scale-=c,this.enableAnimation())},rotateLeft(){this.rotate-=m,this.enableAnimation()},rotateRight(){this.rotate+=m,this.enableAnimation()},renderLazyImage(){return this.$createElement("img",{class:[e("__image"),this.previewDisabled?e("--preview-disabled"):null],attrs:{alt:this.alt,"lazy-error":this.error,"lazy-loading":this.loading},directives:[{name:"lazy",value:this.src}],style:{objectFit:this.fit},on:{load:this.handleLoad,error:this.handleError,click:this.handleClick}})},renderImage(){return this.$createElement("img",{class:[e("__image"),this.previewDisabled?e("--preview-disabled"):null],attrs:{alt:this.alt,src:this.src},style:{objectFit:this.fit},on:{load:this.handleLoad,error:this.handleError,click:this.handleClick}})},closePreview(){this.showPreview=!1,this.keyboardDisabled=!0},handleTouchstart(t){this.touching=!0;const{touches:i}=t;this.prevX=i[0].clientX,this.prevY=i[0].clientY},handleTouchmove(t){if(!this.touching)return;const{touches:i}=t,{clientX:o,clientY:n}=i[0],l=o-this.prevX,h=n-this.prevY;this.translateX+=l/this.scale,this.translateY+=h/this.scale,this.prevX=o,this.prevY=n},handleTouchend(){this.touching=!1},renderPreview(){const t=this.$createElement;return t(f,{class:e("__popup"),attrs:{"image-cover":!0},model:{value:this.showPreview,callback:i=>{this.showPreview=i}}},[t("div",{class:e("__preview-container"),style:{transform:`scale(${this.scale}) translate(${this.translateX}px, ${this.translateY}px)`,transitionDuration:`${this.transitionDuration}ms`},on:{touchstart:this.handleTouchstart,touchmove:this.handleTouchmove,touchend:this.handleTouchend}},[t("img",{class:e("__preview-image"),attrs:{src:this.src,alt:this.alt},style:{transform:`rotate(${this.rotate}deg)`,transitionDuration:`${this.transitionDuration}ms`}})]),t("div",{class:e("__preview-toolbar")},[t(w,{attrs:{wrap:!1}},[t(r,{class:e("__reset-all"),attrs:{"image-cover":!0,type:"primary",round:!0},on:{click:this.resetAll}},[t(a,{attrs:{name:"map-marker-outline"}})]),t(r,{class:e("__rotate-left"),attrs:{"image-cover":!0,type:"primary",round:!0},on:{click:this.rotateLeft}},[t(a,{attrs:{name:"rotate-left"}})]),t(r,{class:e("__rotate-right"),attrs:{"image-cover":!0,type:"primary",round:!0},on:{click:this.rotateRight}},[t(a,{attrs:{name:"rotate-right"}})]),t(r,{class:e("__zoom-in"),attrs:{"image-cover":!0,type:"primary",round:!0},on:{click:this.zoomIn}},[t(a,{attrs:{name:"magnify-plus-outline"}})]),t(r,{class:e("__zoom-out"),attrs:{"image-cover":!0,type:"primary",round:!0},on:{click:this.zoomOut}},[t(a,{attrs:{name:"magnify-minus-outline"}})]),t(r,{class:e("__close-preview"),attrs:{"image-cover":!0,type:"primary",round:!0},on:{click:this.closePreview}},[t(a,{attrs:{name:"close"}})])])])])}},render(){const t=arguments[0],{width:i,height:o,radius:n,block:l,ripple:h,lazy:d,initPreview:p,previewDisabled:v}=this;return t("div",{class:[e(),"m--box",l?null:"m--inline-block"],style:{width:s(i),height:s(o),borderRadius:s(n)}},[t("div",{class:[e("__image-container"),"m--box",l?null:"m--inline-block"],style:{width:s(i),height:s(o),borderRadius:s(n)},directives:[{name:"ripple",value:{disabled:!h}}]},[d?this.renderLazyImage():this.renderImage()]),p&&!v&&this.renderPreview()])}});export{B as I};
